asyncapi: 2.3.0
info:
  title: Stolen Vehicle Tracking
  version: 1.0.0
  description: This service is in charge of track the vehicle
servers:
  vNext:
    url: test
    protocol: mqtt
channels:
  devices/{deviceId}/messages/events/urgnotif:
    parameters:
      deviceId:
        description: unique device identifier
        schema:
          type: string
          examples:
            - 2018000453535
    publish:
      bindings:
        mqtt: qos:1 retain:false
      message:
        name: SVTTracking
        payload:
          type: object
          additionalProperties: false
          properties:
            ApplicationHeader:
              $ref: '#/components/schemas/RemoteNotification/ApplicationHeader'
            ApplicationData:
              $ref: '#/components/schemas/SVTTracking/payload'
          required:
            - ApplicationHeader
            - ApplicationData
  devices/{deviceId}/messages/devicebound/#:
    parameters:
      deviceId:
        description: unique device identifier
        schema:
          type: string
          examples:
            - 2018000453535
    subscribe:
      bindings:
        mqtt: qos:1 retain:false
      message:
        name: SVTSetting
        payload:
          type: object
          additionalProperties: false
          properties:
            ApplicationHeader:
              $ref: '#/components/schemas/RemoteServiceSetting/ApplicationHeader'
            ApplicationData:
              $ref: '#/components/schemas/SVTSettings/payload'
          required:
            - ApplicationHeader
            - ApplicationData
components:
  schemas:
    RemoteNotification:
      ApplicationHeader:
        type: object
        properties:
          GlobalMessageID:
            type: string
            example: 2fff6fa91f414229b829e4f612f79a27
            description: >-
              Global message ID is unique ID amoung all message from IVC & IVI
              to vNext and vice versa
          DataDictionaryVersion:
            type: string
            example: 0.2.16
            description: Version of the Data Dictionary
          MessageType:
            type: string
            example: RemoteNotification
            description: Fixed value for Notification Message
          TargetID:
            type: string
            description: It's the message name
          DevId:
            type: string
            example: 2018000453535
            description: A-IVC ID
          DeviceType:
            type: string
            example: A-IVC2
            description: A-IVC or A-IVI
          VIN:
            type: string
            example: VF1XXXXXXXXXXXXXX
            description: Vehicle identifier number
          BIN:
            type: string
            example: 1234567890123
            description: Battery identifier number (Only for services requiring this field)
          TimeStamp:
            type: string
            format: date-time
            description: UTC of message publication
          CorrelationId:
            type: string
            example: 2fff6fa91f414229b829e4f612f79a27
            description: Correlation ID with answer message
          DCMVersion:
            type: string
            example: 1.6.9.0
            description: version of the message spec
          UserId:
            type: string
            example: AllianceUser
            description: >-
              User Identifier - is received from AIVI (User ID is not used on
              CCS2")
        required:
          - GlobalMessageId
          - DataDictionaryVersion
          - MessageType
          - TargetId
          - DevId
          - DeviceType
          - VIN
          - TimeStamp
          - CorrelationId
          - DCMVersion
    RemoteServiceSetting:
      ApplicationHeader:
        type: object
        properties:
          GlobalMessageID:
            type: string
            example: 2fff6fa91f414229b829e4f612f79a27
            description: >-
              Global message ID is unique ID amoung all message from IVC & IVI
              to vNext and vice versa
          DataDictionaryVersion:
            type: string
            example: 0.2.16
            description: Version of the Data Dictionary
          MessageType:
            type: string
            example: RemoteServiceSetting
            description: Fixed value for Notification Message
          TargetID:
            type: string
            description: It's the message name
          DevId:
            type: string
            example: 2018000453535
            description: A-IVC ID
          DeviceType:
            type: string
            example: A-IVC2
            description: A-IVC or A-IVI
          VIN:
            type: string
            example: VF1XXXXXXXXXXXXXX
            description: Vehicle identifier number
          BIN:
            type: string
            example: 1234567890123
            description: Battery identifier number (Only for services requiring this field)
          TimeStamp:
            type: string
            format: date-time
            description: UTC of message publication
          CorrelationId:
            type: string
            example: 2fff6fa91f414229b829e4f612f79a27
            description: Correlation ID with answer message
          DCMVersion:
            type: string
            example: 1.6.9.0
            description: version of the message spec
          UserId:
            type: string
            example: AllianceUser
            description: >-
              User Identifier - is received from AIVI (User ID is not used on
              CCS2")
        required:
          - GlobalMessageId
          - DataDictionaryVersion
          - MessageType
          - TargetId
          - DevId
          - DeviceType
          - VIN
          - TimeStamp
          - CorrelationId
          - DCMVersion
    SVTTracking:
      payload:
        type: object
        properties:
          TS:
            type: string
            format: date-time
            description: UTC of data collection in the vehicle
          svttt:
            type: string
            description: blablabla
            longLabel: SVT_Tracking/Sent/Notification/TriggerType
            example: "$message.name"
          vlola:
            type: number
            format: double
            description: blablabla
            longLabel: Vehicle/Location/Latitude
            example: 40.745489
          vlolo:
            type: number
            format: double
            description: blablabla
            longLabel: Vehicle/Location/Longitude
            example: -70.165456
          lkal:
            type: number
            format: integer
            description: blablabla
            longLabel: Vehicle/Location/Altitude
            example: 1563
          locval:
            type: number
            format: integer
            description: blablabla
            longLabel: Vehicle/Location/Validity
            example: 1
          sdvk:
            type: number
            format: float
            description: blablabla
            longLabel: Vehicle/Received/Speed/Displayed/Valueinkmh
            example: 75
          vehs:
            type: number
            format: integer
            description: blablabla
            longLabel: VVehicle/Received/Status/VehicleStates
            example: 2
          km:
            type: number
            format: float
            description: em Km
            longLabel: Vehicle/Received/Status/DistanceTotalizer
            example: 2458
          socbat:
            type: number
            format: float
            description: blablabla
            longLabel: Vehicle/Received/Status/EEM/SOCBattery14V
            example: 12
          svtss:
            type: string
            description: blablabla
            longLabel: SVT_Tracking/Sent/Notification/ServiceState
            example: Tracking
          svtci:
            type: number
            format: integer
            description: blablabla
            longLabel: SVT_Tracking/Sent/Notification/CircularIndex
            example: 1
      required:
        - TS
        - vlola
        - vlolo
        - lkal
    SVTSettings:
      payload:
        type: object
        properties:
          svtba:
            type: string
            description: Track mode requested to vehicle
            example: track
      required:
        - svtba
