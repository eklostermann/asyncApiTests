asyncapi: 2.2.0
info:
  title: Stolen Vehicle Tracking
  version: 1.0.0
  description: This service is in charge of track the vehicle
channels:
  devices/{deviceId}/messages/events/urgnotif:
    parameters:
      deviceId:
        description: unique device identifier
        schema:
          type: string
          examples:
            - 2018000453535
    publish:
      bindings:
        mqtt: qos:1 retain:false
      message:
        name: SVTTracking
        payload:
          type: object
          additionalProperties: false
          properties:
            ApplicationHeader:
              $ref: 'https://raw.githubusercontent.com/eklostermann/asyncApiTests/main/DCM_Header_schema.yaml#/components/schemas/SVTTracking/header'
            ApplicationData:
              $ref: '#/components/schemas/SVTTracking/payload'
          required:
            - ApplicationHeader
            - ApplicationData
  devices/{deviceId}/messages/devicebound/#:
    parameters:
      deviceId:
        description: unique device identifier
        schema:
          type: string
          examples:
            - 2018000453535
    subscribe:
      bindings:
        mqtt: qos:1 retain:false
      message:
        name: SVTSetting
        payload:
          type: object
          additionalProperties: false
          properties:
            ApplicationHeader:
              $ref: 'https://raw.githubusercontent.com/eklostermann/asyncApiTests/main/DCM_Header_schema.yaml#/components/schemas/SVTSettings/header'
            ApplicationData:
              $ref: '#/components/schemas/SVTSettings/payload'
          required:
            - ApplicationHeader
            - ApplicationData
components:
  schemas:
    SVTTracking:
      payload:
        type: object
        properties:
          timeStamp:
            $ref: 'https://raw.githubusercontent.com/eklostermann/asyncApiTests/main/MDD_test.yaml#/components/schemas/MDD_list/properties/timeStamp'
          SVTTriggerType:
            $ref: 'https://raw.githubusercontent.com/eklostermann/asyncApiTests/main/MDD_test.yaml#/components/schemas/MDD_list/properties/SVTTriggerType'
          vlola:
            type: number
            format: double
            description: blablabla
            longLabel: Vehicle/Location/Latitude
            example: 40.745489
          vlolo:
            type: number
            format: double
            description: blablabla
            longLabel: Vehicle/Location/Longitude
            example: -70.165456
          lkal:
            type: number
            format: integer
            description: blablabla
            longLabel: Vehicle/Location/Altitude
            example: 1563
          locval:
            type: number
            format: integer
            description: blablabla
            longLabel: Vehicle/Location/Validity
            example: 1
          sdvk:
            type: number
            format: float
            description: blablabla
            longLabel: Vehicle/Received/Speed/Displayed/Valueinkmh
            example: 75
          vehs:
            type: number
            format: integer
            description: blablabla
            longLabel: VVehicle/Received/Status/VehicleStates
            example: 2
          km:
            type: number
            format: float
            description: em Km
            longLabel: Vehicle/Received/Status/DistanceTotalizer
            example: 2458
          socbat:
            type: number
            format: float
            description: blablabla
            longLabel: Vehicle/Received/Status/EEM/SOCBattery14V
            example: 12
          svtss:
            type: string
            description: blablabla
            longLabel: SVT_Tracking/Sent/Notification/ServiceState
            example: Tracking
          svtci:
            type: number
            format: integer
            description: blablabla
            longLabel: SVT_Tracking/Sent/Notification/CircularIndex
            example: 1
      required:
        - TS
        - vlola
        - vlolo
        - lkal
    SVTSettings:
      payload:
        type: object
        properties:
          svtba:
            type: string
            description: Track mode requested to vehicle
            example: track
      required:
        - svtba
